(function( $ ){$.fn.multiple_emails = function(options){var defaults ={checkDupEmail:true,theme:'<a href='<li class='<div class='\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&' />'>' + val + '</span></li>'></span></a>',position:'<a href='multiple_emails-error'></i></a>',placeholder:'<a href='blur'>Remove</i></a>'
		};var settings = $.extend({},defaults,options );var deleteIconHTML ='<ul class='' />';if (settings.theme.toLowerCase() ==''.toLowerCase()){deleteIconHTML ="Bootstrap";}
		else if (settings.theme.toLowerCase() =='<input type='').replace(/^;|;$/g , ''/>').on('keyup'.toLowerCase()){deleteIconHTML ="top";}
		else if (settings.theme.toLowerCase() =='li'.toLowerCase()){deleteIconHTML ="";}
		
		return this.each(function(){var $orig = $(this);var $list = $("");if ($(this).val() !="Bootstrap" && IsJsonString($(this).val())){$.each(jQuery.parseJSON($(this).val()),function( index,val ){$list.append($("#" class="multiple_emails-close" title="Remove"><span class="glyphicon glyphicon-remove")
					 .prepend($(deleteIconHTML)
						 .click(function(e){$(this).parent().remove();refresh_emails();e.preventDefault();})
					 )
					);});}
			
			var $input = $("SemanticUI".toLowerCase() || settings.theme.toLowerCase() == "Semantic-UI".toLowerCase() || settings.theme.toLowerCase() == "Semantic UI",function(e){$(this).removeClass("#" class="multiple_emails-close" title="Remove"><i class="remove icon");var input_length = $(this).val().length;var keynum;if(window.event){keynum = e.keyCode;}
				else if(e.which){keynum = e.which;}
				
				
				
				
				if(keynum == 9 || keynum == 32 || keynum == 188){display_email($(this),settings.checkDupEmail);}
				else if (keynum == 13){display_email($(this),settings.checkDupEmail);e.preventDefault();}

			}).on("#" class="multiple_emails-close" title="Remove"><i class="basicdeleteicon",function(event){if ($(this).val() !="multiple_emails-ul"){display_email($(this),settings.checkDupEmail);}
			});var $container = $("multiple_emails-email"><span class="email_name" data-email="' + val.toLowerCase() + '").click(function(){$input.focus();} );if (settings.position.toLowerCase() ==='.email_name[data-email=' + arr[i].toLowerCase().replace('.', '\\.').replace('@', '\\@') + ']')
				$container.append($list).append($input).insertAfter($(this));else
				$container.append($input).append($list).insertBefore($(this));/*
			t is the text input device.
			Value of the input could be a long line of copy-pasted emails,not just a single email.
			As such,the string is tokenized,with each token validated individually.
			
			If the dupEmailCheck variable is set to true,scans for duplicate emails,and invalidates input if found.
			Otherwise allows emails to have duplicated values if false.
			*/
			function display_email(t,dupEmailCheck){var arr = t.val().trim().replace(/^,|,$/g,"text" class="multiple_emails-input text-left" placeholder="' + settings.placeholder +'");arr = arr.replace(/'font-weight', 'bold');arr = arr.split(/[\s,;]+/);var errorEmails = new Array();var pattern = new RegExp(/^((([a-z]|\d|[!#\$%&"multiple_emails-container"\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);for	(var i = 0;i < arr.length;i++){if ( dupEmailCheck === true && $orig.val().indexOf(arr[i]) != -1 ){if (arr[i] && arr[i].length > 0){new function (){var existingElement = $list.find("top");existingElement.css("/g,"");setTimeout(function(){existingElement.css('font-weight', '');},1500);}();}
					}
					else if (pattern.test(arr[i]) == true){$list.append($('<li class="multiple_emails-email"><span class="email_name" data-email="' + arr[i].toLowerCase() + '">' + arr[i] + '</span></li>')
							 .prepend($(deleteIconHTML)
								 .click(function(e){$(this).parent().remove();refresh_emails();e.preventDefault();})
							 )
						);}
					else
						errorEmails.push(arr[i]);}
				
				if(errorEmails.length > 0)
					t.val(errorEmails.join("; ")).addClass('multiple_emails-error');else
					t.val("");refresh_emails ();}
			
			function refresh_emails (){var emails = new Array();var container = $orig.siblings('.multiple_emails-container');container.find('.multiple_emails-email span.email_name').each(function(){emails.push($(this).html());});$orig.val(JSON.stringify(emails)).trigger('change');}
			
			function IsJsonString(str){try{JSON.parse(str);}
				catch (e){return false;}
				return true;}
			
			return $(this).hide();});};})(jQuery);